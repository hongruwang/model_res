C     VERSION(8/6/96)
C
C >>>> PARAMETERS
C
C      确定网格的最大最小值       
 
   	    PARAMETER (IJM=40,KB= 6,KSL=6,KSMAX=2,LAYMAX=7) !ESL    
 
	    PARAMETER (NUMMA=20) !QSH new  

  
C	
C >>>> OTHER PARAMETERS
C
      PARAMETER ( KBM1=KB-1)
      PARAMETER ( KBM2=KB-2)
CW      PARAMETER (IMM1=IM-1,JMM1=JM-1,KBM1=KB-1)
CW      PARAMETER (IMM2=IM-2,JMM2=JM-2,KBM2=KB-2)


      PARAMETER (MAXWET=IJM)
       PARAMETER (NUMA=20)
C
C  MAX NUMBER OF LAYERS IN CHEM BED MODEL
C
      PARAMETER (NBEDMAX=100)
C
C
      REAL ISPI,ISP2I,KM,KH,KQ,L,NU
      INTEGER EPTS,VPTS,FPTS
      INTEGER IHISTM,ITRACM,EPTSM,VPTSM,FPTSM,EBCM,QBCM,DBCM,PSCM
      PARAMETER (IHISTM=50000,ITRACM=9000)
      PARAMETER (EPTSM=500,VPTSM=500,FPTSM=500)
      PARAMETER (EBCM=500,QBCM=3000,DBCM=3000,PSCM=100,UPBCM=3000)
C
C*********************************************************************
C
C  FOR PARTICLE TRACKING 
C
C  NSRCM  = MAXIMUM NO. OF PARTICLE SOURCES
C  NPARTM = MAXIMUM NO. OF PARTICLES/RELEASE
C  NCONVM = MAXIMUM NO. OF PARTICLE RELEASES BEFORE CONVERSION TO
C           CONCENTRATION
C
C  NOTE:  MAX. NO. OF PARTICLES = NPARTM * NCONVM
C
      PARAMETER (NSRCM=5,NPARTM=100,NCONVM=1000)
C
C*********************************************************************
C
      LOGICAL CONSPLT,CONSTSR,CONSTRN
C
      CHARACTER*1  VSX,VSY,PTU,PTV,PTW,PTAM,PTS,PTT,PRHO,
     .             PTQ2,PTL,PTKM,PTKH
      CHARACTER*3  DEV
      CHARACTER*4  DIRFLX, SEDTYPE, OPTPSTR
      CHARACTER*7 TRACER
C
      CHARACTER*5 PDEPFORM
      CHARACTER*7 SEDTRAN,CHEMTRAN,PARTICLE,SHERODE
      CHARACTER*7 VARIP0,VARIA0N,SEDLOAD,VARIBULK
      CHARACTER*8 WAVEDYN,HYDTYPE



C
      CHARACTER*10 TOR,ADVECT,HORZMIX,VERTMIX,SCHEME
      CHARACTER OPTEXTC*4
      CHARACTER*20 OPTEBC,OPTTSI,OPTMBC
C
     
C
      REAL*8 ARCTHIK(IJM),THSAVE(VPTSM)
C
      REAL NIKURH,KHZSAVE,KMZSAVE
C
      REAL*8 SEDMASS(NBEDMAX,IJM),CHEMMASS(NBEDMAX,IJM),
     +             SEDDEP(IJM)
C 
      DATA RHO0/1000./


      COMMON/BLKCON/ISPI,ISP2I,SMOTH,THETA,DAYI,NSTEPS,IRAMP,ZBINI,IKSL,
     .    DTE,DTI,HPRNU,VPRNU,UMOL,GRAV,RAMP,NU,HORCON,ALPHA,TLAG,TIME,
     .    THOUR,ISTART,IEND,INTX,IEXT,IPRINT,IPRTSTART,KAVGE,ISKILL,
     .    ISRCH,ISHRU,ISSUB,IUUAV,NUMHRU,NUMSUB,IUPLT,INPCY(100),IUTSR,
     .    IATRN(300),IUQIF(300),IUWRS(300),IUT90,IUT91,IUT92,IUT93,IUT94,
     .    IUT191,IUT192,IUT193,ISPLIT,IUT194,IAVGE,IUT96,IUT95,
     .	 INTXH,DTIHT,IJCHA,DTIT,TIMENOW

	  COMMON/BLKCON2/ADVECT,SCHEME,HORZMIX,VERTMIX,OPTEBC,OPTTSI,OPTMBC
     .   ,OPTEXTC,TOR

      COMMON/BLKCON1/IUTECP(300),IUREDS(300),IWTSTEPS,IntHotTime

C
      COMMON /BLK2/ TSOPTION,SEDTRAN,
     +                 PDEPFORM,CHEMTRAN,WAVEDYN,HYDTYPE,SEDTYPE,
     +                 VARIBULK, OPTPSTR
	  COMMON /TNZER0/TRNZERO,ANPLPF,AVGE
C
      COMMON /BLKCON4/IUT401,IUT402,IUT403,IUT404,IUT405,IUT406
      COMMON /BLKCON5/IUT501,IUT502,IUT503,IUT504,IUT505,IUT506
      COMMON /BLKCON6/IUT601,IUT602,IUT603,IUT604,IUT605,IUT606
      COMMON /BLKCON7/IUT701,IUT702,IUT703,IUT704,IUT705
      COMMON /BLKCON8/IUT801,ITMP
C
C--------------- PRINT CONTROL ARRAYS ----------------------------------
C
      COMMON/BLKPRT/IROW,JROW
      COMMON/BLKCHR/
     .    DEV,VSX,VSY,PTU,PTV,PTW,PTAM,PTS,PTT,
     .    PRHO,PTQ2,PTL,PTKM,PTKH
C
C---------------- 1-D ARRAYS ----定义一维数组-----------------------
C
      COMMON/BLK1D/
     .    DZR(KB),Z(KB),ZZ(KB),DZ(KB),DZZ(KB),
     .    DPTHSL(KSL),TSI(KSL),SSI(KSL)

C
C---------------- Namefile (定义全局的fname，先申明，在定义为common)----
C
       CHARACTER*100 NAMEFILE,FNAME(50),FNAMEWRITEHOT(100),STARTFILE
       CHARACTER*100 FNAMETRAN(300),FNAMEQDIF(300),FNAMEHOT(300) 
       CHARACTER*100 FNAMGCMDM(300),FNAMEGEO,FNAMMONI(300)
       CHARACTER*100 FNAMGCOM(300) ,FNAMETECPL(300),FNAMEIN(50)
       CHARACTER*4 NAME_RES(300)  
 
       COMMON/FNA1/ NAMEFILE,FNAME,STARTFILE,FNAMETRAN,FNAMEQDIF,FNAMEIN
        COMMON/FNA2/ FNAMEHOT,FNAMEWRITEHOT 
       COMMON/FNA3/  FNAMGCMDM,FNAMETECPL,FNAMGCOM,NAME_RES


C
C---------------- 2-D ARRAYS --定义二维数组-------------------------------
C
      COMMON/BLK2D/
     .    ZB(IJM),UA(IJM),VA(IJM),EL(IJM),MFS(IJM),MKIJ(IJM),  
     .    ART(IJM),UTF(IJM),  
     .    MDV(IJM),CARAY(IJM,KB,26)


       COMMON/BLK2D_1/X0(IJM),Y0(IJM),NI,NJ,LI(IJM),IBOUN(IJM)
       COMMON/BL2/IJ0(IJM),IJ_LNP(IJM,4),I0(IJM),J0(IJM)
C-----------------------------双精度二维参数-------------------------------
 
cw          DOUBLE PRECISION  EL,ELF,ELB,EGF,EGB,ETF,ETB
cw          DOUBLE PRECISION  UA,VA,UTF,VTF,UTB,VTB
cw          DOUBLE PRECISION  UAB,VAB,VAF,UAF

 

CW          DOUBLE PRECISION  EL,ELF,EGF,EGB,ELB,ETF,ET,ZB,A,C
CW          DOUBLE PRECISION  UAF,UA,VAF,VA,UTF,VTF,UTB,VTB,UAB,VAB
CW          DOUBLE PRECISION  ADVUU,ADVVV,ADVUA,ADVVA
CW          DOUBLE PRECISION  UF,VF,UB,VB,Q2B,Q2
CW          DOUBLE PRECISION  AAM2D ,U,V
CW          DOUBLE PRECISION  D,DT,DZ,VH,VHP
CW          DOUBLE PRECISION  TB,T
CW          DOUBLE PRECISION  FLUXUA,FLUXVA,PROD,XMFLUX,YMFLUX

 

C
C---------------- 3-D ARRAYS ---定义三维数组--------------------------------
C
      COMMON/BLK3D/
    
     .    XMFL3D(IJM,KB),
     .    YMFL3D(IJM,KB),UF(IJM,KB),VF(IJM,KB),KM(IJM,KB),
     .    KH(IJM,KB),KQ(IJM,KB),L(IJM,KB),Q2(IJM,KB),
     .    Q2B(IJM,KB),AAM(IJM,KB),Q2L(IJM,KB),Q2LB(IJM,KB),
     .    U(IJM,KB),UB(IJM,KB),W(IJM,KB),WR(IJM,KB),
     .    V(IJM,KB),VB(IJM,KB),T(IJM,KB),TB(IJM,KB),
     .    S(IJM,KB),SB(IJM,KB),RHO(IJM,KB),RMEAN(IJM,KB),
     .    TMEAN(IJM,KB),SMEAN(IJM,KB),L2(IJM,KB),Q2L2(IJM,KB),
     .    AAMAX(IJM,KB),AAMAY(IJM,KB),Q2LB2(IJM,KB),
     .    L3(IJM,KB),Q2L3(IJM,KB),Q2LB3(IJM,KB)
C
C----------- ARCHIVING AND SKILL ASSESSMENT ARRAYS ---------------------
C
  
C
C---------------------- BOUNDARY VALUE ARRAYS --------------------------
C
  
C
C---------------- SEDIMENT TRANSPORT -----------------------------------
C
      COMMON /SED1/A0IN,ALPHAS,WS2,TCRDEP,TCRDP2,RESEXP,N24CNT,N24HR,
     +         EXPM,IP0,IA0,XNSBED,IBED,UCR2,DENNON,DENCOH,BPOR,SUSARM,
     +         KSED,WS1MIN
C
      COMMON /SED2/IBMSK(IJM),LAYER(LAYMAX,IJM)
C   
     
C  FOR SGI COMPILING
 
C
C  CHEMICAL TRANSPORT
 
    
      COMMON /CHEM2/NCHEMLAY,NACTLAY,CHEMTHIK,CHEMACT,
     +             CBEDCHEM(NBEDMAX,IJM)
      COMMON /CHEM3/SEDMASS
      COMMON /CHEM4/CHEMMASS
      COMMON /CHEM5/SEDDEP 
     
 
C  FOR PARTICLE TRACKING
C
      COMMON /PTRACK0/PARTICLE
C

C
      COMMON /PTRACK2/CP(IJM,KB)
C
 
C
 
C
      COMMON /PTRACK5/XCOR(IJM),YCOR(IJM),H1P(IJM),
     +              H2P(IJM)
C
      COMMON /PTRACK6/KPART(NPARTM)
C
      COMMON /PTRACK7/IJSOURCE(NSRCM),KSOURCE(NSRCM)
C
C     FOR WAVE MODEL BASED ON SCHWAB MODEL   BY QA
C
      COMMON /WAVEBLK1/CO(IJM),XMOM(IJM),YMOM(IJM),
     2 SIG(IJM),CS(IJM),SN(IJM),NR
      COMMON /WAVEBLK2/ WU(IJM),WV(IJM),
     1 WU1(IJM),WV1(IJM),
     2 WU2(IJM),WV2(IJM),T1WV,T2WV,HSIG(IJM)
C
C
C     FOR DIFFERENT TYPE OF OPEN BOUNDARY CONDITIONS BY Quamrul QA 12/28/98
C
      CHARACTER*10 BCTYPE,STARTDAY
      COMMON /OBCBLK/BCTYPE STARTDAY

      
 


	   COMMON/DWBC1/IJDWD_ORG(3000),IJDWC_ORG(3000),NUNDWTR

	   COMMON/DWBC1/NU_OUT_MA(300),N_OUT_MA(10,500),EHF(10,500)
	   COMMON/DWBC1/KTYPE_OUT_MA(10,300),IJ_OUT_MA(500,10,300)


	   	COMMON/mon1/NUMMONI,IJMONI(5000,5000),ISDEBUG
		COMMON/mon2/numtime1,numtime2,mmoni
	   	COMMON/mon3/NUMMONJ,NUMMONIJ,IMONI(1000),JMONI(1000)
	   	COMMON/mon4/NUMIS(5000),NUMJS(5000),IJMONJ(5000,5000)
	   	COMMON/mon5/I2ID(500),I3ID(500),ISHRUALL,ISHRUCITY
		COMMON/MON6/ISTOALL,MASTART,MAEND,ISECOMUV,ISQCHECK,ISQCHEAVE


	    COMMON/N3D1/NUM3DS,NUM3DK(100),NUM3DKIJ(100),IJ3DIJ(100,30,100)
	    COMMON/N3D2/NUMZIJS(30,100),NUMHRUS
 

	   	COMMON/mon6/ ISSUBALL,ISRCHALL,NUMMONS(12)



	   	COMMON/mon7/ ISSUBAMON,ISSUBAYEA  
